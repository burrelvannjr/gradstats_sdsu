tab <- function(df, var1, var2){
#v1 <- paste0(substitute(df),"$",substitute(var1))
#v2 <- paste0(substitute(df),"$",substitute(var2))
#print(eval(substitute(var1), df))
v1 <- (eval(substitute(var1), df))
v1 <- as.data.frame(v1)
v2 <- (eval(substitute(var2), df))
v2 <- as.data.frame(v2)
names(v1) <- paste0(substitute(df),"$",substitute(var1))
names(v2) <- paste0(substitute(df),"$",substitute(var2))
print(v1)
print(v2)
#chisq.test((eval(substitute(var1), df)), (eval(substitute(var2), df)), correct=FALSE)
#chisq.test(v1, v2, correct=FALSE)
#crosstab$observed
#crosstab$expected
}
tab(mtcars, am, cyl)
tab <- function(df, var1, var2){
#v1 <- paste0(substitute(df),"$",substitute(var1))
#v2 <- paste0(substitute(df),"$",substitute(var2))
#print(eval(substitute(var1), df))
v1 <- (eval(substitute(var1), df))
v1 <- as.data.frame(v1)
v2 <- (eval(substitute(var2), df))
v2 <- as.data.frame(v2)
names(v1) <- paste0(substitute(df),"$",substitute(var1))
names(v2) <- paste0(substitute(df),"$",substitute(var2))
print(v1)
print(v2)
#chisq.test((eval(substitute(var1), df)), (eval(substitute(var2), df)), correct=FALSE)
chisq.test(v1, v2, correct=FALSE)
#crosstab$observed
#crosstab$expected
}
tab(mtcars, am, cyl)
tab <- function(df, var1, var2){
#v1 <- paste0(substitute(df),"$",substitute(var1))
#v2 <- paste0(substitute(df),"$",substitute(var2))
#print(eval(substitute(var1), df))
v1 <- (eval(substitute(var1), df))
v1 <- as.data.frame(v1)
v2 <- (eval(substitute(var2), df))
v2 <- as.data.frame(v2)
names(v1) <- substitute(var1)
names(v2) <- substitute(var2)
print(v1)
print(v2)
#chisq.test((eval(substitute(var1), df)), (eval(substitute(var2), df)), correct=FALSE)
chisq.test(v1, v2, correct=FALSE)
#crosstab$observed
#crosstab$expected
}
tab(mtcars, am, cyl)
tab <- function(df, var1, var2){
#v1 <- paste0(substitute(df),"$",substitute(var1))
#v2 <- paste0(substitute(df),"$",substitute(var2))
#print(eval(substitute(var1), df))
v1 <- (eval(substitute(var1), df))
v1 <- as.data.frame(v1)
v2 <- (eval(substitute(var2), df))
v2 <- as.data.frame(v2)
names(v1) <- substitute({{var1}})
names(v2) <- substitute({{var2}})
print(v1)
print(v2)
#chisq.test((eval(substitute(var1), df)), (eval(substitute(var2), df)), correct=FALSE)
chisq.test(v1, v2, correct=FALSE)
#crosstab$observed
#crosstab$expected
}
tab(mtcars, am, cyl)
tab <- function(df, var1, var2){
#v1 <- paste0(substitute(df),"$",substitute(var1))
#v2 <- paste0(substitute(df),"$",substitute(var2))
#print(eval(substitute(var1), df))
v1 <- (eval(substitute(var1), df))
v1 <- as.data.frame(v1)
v2 <- (eval(substitute(var2), df))
v2 <- as.data.frame(v2)
names(v1) <- deparse(substitute(var1))
names(v2) <- deparse(substitute(var2))
print(v1)
print(v2)
#chisq.test((eval(substitute(var1), df)), (eval(substitute(var2), df)), correct=FALSE)
chisq.test(v1, v2, correct=FALSE)
#crosstab$observed
#crosstab$expected
}
tab(mtcars, am, cyl)
tab <- function(df, var1, var2){
#v1 <- paste0(substitute(df),"$",substitute(var1))
#v2 <- paste0(substitute(df),"$",substitute(var2))
#print(eval(substitute(var1), df))
v1 <- (eval(substitute(var1), df))
#v1 <- as.data.frame(v1)
v2 <- (eval(substitute(var2), df))
#v2 <- as.data.frame(v2)
#names(v1) <- deparse(substitute(var1))
#names(v2) <- deparse(substitute(var2))
#print(v1)
#print(v2)
#chisq.test((eval(substitute(var1), df)), (eval(substitute(var2), df)), correct=FALSE)
chisq.test(v1, v2, correct=FALSE)
#crosstab$observed
#crosstab$expected
}
tab(mtcars, am, cyl)
tab <- function(df, var1, var2){
#v1 <- paste0(substitute(df),"$",substitute(var1))
#v2 <- paste0(substitute(df),"$",substitute(var2))
#print(eval(substitute(var1), df))
v1 <- (eval(substitute(var1), df))
#v1 <- as.data.frame(v1)
v2 <- (eval(substitute(var2), df))
#v2 <- as.data.frame(v2)
names(v1) <- deparse(substitute(var1))
#names(v2) <- deparse(substitute(var2))
#print(v1)
#print(v2)
#chisq.test((eval(substitute(var1), df)), (eval(substitute(var2), df)), correct=FALSE)
chisq.test(v1, v2, correct=FALSE)
#crosstab$observed
#crosstab$expected
}
tab(mtcars, am, cyl)
tab(mtcars$am, mtcars$cyl)
tab <- function(df, var1, var2){
#v1 <- paste0(substitute(df),"$",substitute(var1))
#v2 <- paste0(substitute(df),"$",substitute(var2))
#print(eval(substitute(var1), df))
{{ v1 }} <- (eval(substitute(var1), df))
#v1 <- as.data.frame(v1)
#v2 <- (eval(substitute(var2), df))
#v2 <- as.data.frame(v2)
#names(v1) <- deparse(substitute(var1))
#names(v2) <- deparse(substitute(var2))
#print(v1)
#print(v2)
#chisq.test((eval(substitute(var1), df)), (eval(substitute(var2), df)), correct=FALSE)
chisq.test(v1, v2, correct=FALSE)
#crosstab$observed
#crosstab$expected
}
tab <- function(df, var1, var2){
#v1 <- paste0(substitute(df),"$",substitute(var1))
#v2 <- paste0(substitute(df),"$",substitute(var2))
#print(eval(substitute(var1), df))
{{ var1 }} <- (eval(substitute(var1), df))
{{ var2 }} <- (eval(substitute(var1), df))
#v1 <- as.data.frame(v1)
#v2 <- (eval(substitute(var2), df))
#v2 <- as.data.frame(v2)
#names(v1) <- deparse(substitute(var1))
#names(v2) <- deparse(substitute(var2))
#print(v1)
#print(v2)
#chisq.test((eval(substitute(var1), df)), (eval(substitute(var2), df)), correct=FALSE)
chisq.test(v1, v2, correct=FALSE)
#crosstab$observed
#crosstab$expected
}
tab <- function(df, var1, var2){
#v1 <- paste0(substitute(df),"$",substitute(var1))
#v2 <- paste0(substitute(df),"$",substitute(var2))
#print(eval(substitute(var1), df))
{{ var1 }} <- (eval(substitute(var1), df))
{{ var2 }} <- (eval(substitute(var2), df))
#v1 <- as.data.frame(v1)
#v2 <- (eval(substitute(var2), df))
#v2 <- as.data.frame(v2)
#names(v1) <- deparse(substitute(var1))
#names(v2) <- deparse(substitute(var2))
#print(v1)
#print(v2)
#chisq.test((eval(substitute(var1), df)), (eval(substitute(var2), df)), correct=FALSE)
chisq.test(v1, v2, correct=FALSE)
#crosstab$observed
#crosstab$expected
}
tab <- function(df, var1, var2){
#v1 <- paste0(substitute(df),"$",substitute(var1))
#v2 <- paste0(substitute(df),"$",substitute(var2))
#print(eval(substitute(var1), df))
{{ var1 }} <- (eval(substitute(var1), df))
{{ var2 }} <- (eval(substitute(var2), df))
#v1 <- as.data.frame(v1)
#v2 <- (eval(substitute(var2), df))
#v2 <- as.data.frame(v2)
#names(v1) <- deparse(substitute(var1))
#names(v2) <- deparse(substitute(var2))
#print(v1)
#print(v2)
#chisq.test((eval(substitute(var1), df)), (eval(substitute(var2), df)), correct=FALSE)
chisq.test({{var1}}, {{var2}}, correct=FALSE)
#crosstab$observed
#crosstab$expected
}
tab(mtcars$am, mtcars$cyl)
tab(mtcars, am, cyl)
tab <- function(df, var1, var2){
#v1 <- paste0(substitute(df),"$",substitute(var1))
#v2 <- paste0(substitute(df),"$",substitute(var2))
#print(eval(substitute(var1), df))
{{ var1 }} <- (eval(substitute(var1), df))
{{ var2 }} <- (eval(substitute(var2), df))
{{ var1 }}
#v1 <- as.data.frame(v1)
#v2 <- (eval(substitute(var2), df))
#v2 <- as.data.frame(v2)
#names(v1) <- deparse(substitute(var1))
#names(v2) <- deparse(substitute(var2))
#print(v1)
#print(v2)
#chisq.test((eval(substitute(var1), df)), (eval(substitute(var2), df)), correct=FALSE)
#chisq.test({{var1}}, {{var2}}, correct=FALSE)
#crosstab$observed
#crosstab$expected
}
tab(mtcars, am, cyl)
tab <- function(df, var1, var2){
#v1 <- paste0(substitute(df),"$",substitute(var1))
#v2 <- paste0(substitute(df),"$",substitute(var2))
#print(eval(substitute(var1), df))
{{ var1 }} <- (eval(substitute(var1), df))
{{ var2 }} <- (eval(substitute(var2), df))
{{ var1 }}
#v1 <- as.data.frame(v1)
#v2 <- (eval(substitute(var2), df))
#v2 <- as.data.frame(v2)
#names(v1) <- deparse(substitute(var1))
#names(v2) <- deparse(substitute(var2))
#print(v1)
#print(v2)
chisq.test((eval(substitute(var1), df)), (eval(substitute(var2), df)), correct=FALSE)
#chisq.test({{var1}}, {{var2}}, correct=FALSE)
#crosstab$observed
#crosstab$expected
}
tab(mtcars, am, cyl)
tab <- function(df, var1, var2){
#v1 <- paste0(substitute(df),"$",substitute(var1))
#v2 <- paste0(substitute(df),"$",substitute(var2))
#print(eval(substitute(var1), df))
#v1 <- as.data.frame(v1)
#v2 <- (eval(substitute(var2), df))
#v2 <- as.data.frame(v2)
#names(v1) <- deparse(substitute(var1))
#names(v2) <- deparse(substitute(var2))
#print(v1)
#print(v2)
chisq.test((eval(substitute(var1), df)), (eval(substitute(var2), df)), correct=FALSE)
#chisq.test({{var1}}, {{var2}}, correct=FALSE)
#crosstab$observed
#crosstab$expected
}
tab(mtcars, am, cyl)
library(help = "stats").
library(help = "stats")
data1[,mpg]
df[c("mpg")]
df[c("mpg","cyl")]
data1[c("mpg","cyl")]
data1[,c("mpg","cyl")]
data1[,"cyl"]
tab <- function(df, var1, var2){
#v1 <- paste0(substitute(df),"$",substitute(var1))
#v2 <- paste0(substitute(df),"$",substitute(var2))
#v1 <- (eval(substitute(var1), df))
#v2 <- (eval(substitute(var2), df))
#names(v1) <- deparse(substitute(var1))
#names(v2) <- deparse(substitute(var2))
chisq.test(df[,deparse(substitute(var1))], df[,deparse(substitute(var2))], correct=FALSE)
#crosstab$observed
#crosstab$expected
}
tab(mtcars, am, cyl)
chisq.test(mtcars$mpg, mtcars$cyl, correct=FALSE)
View(crosstab)
cross <- chisq.test(mtcars$mpg, mtcars$cyl, correct=FALSE)
cross$data.name
View(cross)
tab <- function(df, var1, var2){
#v1 <- paste0(substitute(df),"$",substitute(var1))
#v2 <- paste0(substitute(df),"$",substitute(var2))
#v1 <- (eval(substitute(var1), df))
#v2 <- (eval(substitute(var2), df))
#names(v1) <- deparse(substitute(var1))
#names(v2) <- deparse(substitute(var2))
crosstab <- chisq.test(df[,deparse(substitute(var1))], df[,deparse(substitute(var2))], correct=FALSE)
crosstab$data.name <- paste0(deparse(substitute(var1)), " and ", deparse(substitute(var2)))
#crosstab$observed
#crosstab$expected
}
tab <- function(df, var1, var2){
#v1 <- paste0(substitute(df),"$",substitute(var1))
#v2 <- paste0(substitute(df),"$",substitute(var2))
#v1 <- (eval(substitute(var1), df))
#v2 <- (eval(substitute(var2), df))
#names(v1) <- deparse(substitute(var1))
#names(v2) <- deparse(substitute(var2))
crosstab <- chisq.test(df[,deparse(substitute(var1))], df[,deparse(substitute(var2))], correct=FALSE)
crosstab$data.name <- paste0(deparse(substitute(var1)), " and ", deparse(substitute(var2)))
crosstab
#crosstab$observed
#crosstab$expected
}
tab(mtcars, am, cyl)
tab <- function(df, var1, var2){
#v1 <- paste0(substitute(df),"$",substitute(var1))
#v2 <- paste0(substitute(df),"$",substitute(var2))
v1 <- (eval(substitute(var1), df))
v2 <- (eval(substitute(var2), df))
#names(v1) <- deparse(substitute(var1))
#names(v2) <- deparse(substitute(var2))
#crosstab <- chisq.test(df[,deparse(substitute(var1))], df[,deparse(substitute(var2))], correct=FALSE)
crosstab <- chisq.test(v1, v2, correct=FALSE)
crosstab$data.name <- paste0(deparse(substitute(var1)), " and ", deparse(substitute(var2)))
crosstab
#crosstab$observed
#crosstab$expected
}
tab(mtcars, am, cyl)
tab <- function(df, var1, var2){
#v1 <- paste0(substitute(df),"$",substitute(var1))
#v2 <- paste0(substitute(df),"$",substitute(var2))
v1 <- (eval(substitute(var1), df))
v2 <- (eval(substitute(var2), df))
#names(v1) <- deparse(substitute(var1))
#names(v2) <- deparse(substitute(var2))
#crosstab <- chisq.test(df[,deparse(substitute(var1))], df[,deparse(substitute(var2))], correct=FALSE)
crosstab <- chisq.test(v1, v2, correct=FALSE)
crosstab$data.name <- paste0(deparse(substitute(var1)), " and ", deparse(substitute(var2)))
#crosstab
crosstab$observed
#crosstab$expected
}
tab(mtcars, am, cyl)
tab <- function(df, var1, var2){
#v1 <- paste0(substitute(df),"$",substitute(var1))
#v2 <- paste0(substitute(df),"$",substitute(var2))
v1 <- (eval(substitute(var1), df))
v2 <- (eval(substitute(var2), df))
#names(v1) <- deparse(substitute(var1))
#names(v2) <- deparse(substitute(var2))
#crosstab <- chisq.test(df[,deparse(substitute(var1))], df[,deparse(substitute(var2))], correct=FALSE)
crosstab <- chisq.test(v1, v2, correct=FALSE)
crosstab$data.name <- paste0(deparse(substitute(var1)), " and ", deparse(substitute(var2)))
#crosstab
names(crosstab$observed) <- c(deparse(substitute(var1)),deparse(substitute(var2)))
crosstab$observed
#crosstab$expected
}
tab(mtcars, am, cyl)
tab <- function(df, var1, var2){
#v1 <- paste0(substitute(df),"$",substitute(var1))
#v2 <- paste0(substitute(df),"$",substitute(var2))
v1 <- (eval(substitute(var1), df))
v2 <- (eval(substitute(var2), df))
#names(v1) <- deparse(substitute(var1))
#names(v2) <- deparse(substitute(var2))
#crosstab <- chisq.test(df[,deparse(substitute(var1))], df[,deparse(substitute(var2))], correct=FALSE)
crosstab <- chisq.test(v1, v2, correct=FALSE)
crosstab$data.name <- paste0(deparse(substitute(var1)), " and ", deparse(substitute(var2)))
#crosstab
names(crosstab$observed)
crosstab$observed
#crosstab$expected
}
tab(mtcars, am, cyl)
View(cross)
cross[["expected"]]
crosstab$observed
names(crosstab$observed)
crosstab$observed[1]
crosstab$observed[0]
crosstab$observed[2]
crosstab$observed[,1]
crosstab$observed[,0]
crosstab$observed[,4]
crosstab$observed[,3]
crosstab$observed[0,]
crosstab$observed[1,]
crosstab$observed[0,]
crosstab$observed
crosstab$observed[2,]
crosstab$observed
rownames(crosstab$observed)
colnames(crosstab$observed)
names(crosstab$observed)
is.table(crosstab$observed)
dimnames(crosstab$observed)
dimnames(crosstab$observed)[1]
names(dimnames(crosstab$observed))
tab <- function(df, var1, var2){
#v1 <- paste0(substitute(df),"$",substitute(var1))
#v2 <- paste0(substitute(df),"$",substitute(var2))
v1 <- (eval(substitute(var1), df))
v2 <- (eval(substitute(var2), df))
#names(v1) <- deparse(substitute(var1))
#names(v2) <- deparse(substitute(var2))
#crosstab <- chisq.test(df[,deparse(substitute(var1))], df[,deparse(substitute(var2))], correct=FALSE)
crosstab <- chisq.test(v1, v2, correct=FALSE)
crosstab$data.name <- paste0(deparse(substitute(var1)), " and ", deparse(substitute(var2)))
#crosstab
names(dimnames(crosstab$observed)) <- c(deparse(substitute(var1)),deparse(substitute(var2)))
crosstab$observed
#crosstab$expected
}
tab(mtcars, am, cyl)
tab <- function(df, var1, var2){
options(warn=-1)
#v1 <- paste0(substitute(df),"$",substitute(var1))
#v2 <- paste0(substitute(df),"$",substitute(var2))
v1 <- (eval(substitute(var1), df))
v2 <- (eval(substitute(var2), df))
#names(v1) <- deparse(substitute(var1))
#names(v2) <- deparse(substitute(var2))
#crosstab <- chisq.test(df[,deparse(substitute(var1))], df[,deparse(substitute(var2))], correct=FALSE)
crosstab <- chisq.test(v1, v2, correct=FALSE, war)
crosstab$data.name <- paste0(deparse(substitute(var1)), " and ", deparse(substitute(var2)))
#crosstab
names(dimnames(crosstab$observed)) <- c(deparse(substitute(var1)),deparse(substitute(var2)))
crosstab$observed
#crosstab$expected
options(warn=0)
}
tab(mtcars, am, cyl)
tab <- function(df, var1, var2){
options(warn=-1)
#v1 <- paste0(substitute(df),"$",substitute(var1))
#v2 <- paste0(substitute(df),"$",substitute(var2))
v1 <- (eval(substitute(var1), df))
v2 <- (eval(substitute(var2), df))
#names(v1) <- deparse(substitute(var1))
#names(v2) <- deparse(substitute(var2))
#crosstab <- chisq.test(df[,deparse(substitute(var1))], df[,deparse(substitute(var2))], correct=FALSE)
crosstab <- chisq.test(v1, v2, correct=FALSE, war)
options(warn=0)
crosstab$data.name <- paste0(deparse(substitute(var1)), " and ", deparse(substitute(var2)))
#crosstab
names(dimnames(crosstab$observed)) <- c(deparse(substitute(var1)),deparse(substitute(var2)))
crosstab$observed
#crosstab$expected
}
tab(mtcars, am, cyl)
c(crosstab$observed, crosstab$expected)
cbind(crosstab$observed, crosstab$expected)
list(crosstab$observed, crosstab$expected)
a <- list(crosstab$observed, crosstab$expected)
dimnames(a)
dimnames(a) <- c("obv","exp")
names(a)
a[1]
a[2]
a
a[[1]]
names(a) <- c("1","2")
a
tab <- function(df, var1, var2){
options(warn=-1) # suppress warnings for chi square run
#v1 <- paste0(substitute(df),"$",substitute(var1)) # how to use $ operator in dataframe$variable
#v2 <- paste0(substitute(df),"$",substitute(var2)) # how to use $ operator in dataframe$variable
v1 <- (eval(substitute(var1), df))
v2 <- (eval(substitute(var2), df))
crosstab <- chisq.test(v1, v2, correct=FALSE, war)
options(warn=0) # unsuppress warnings for chi square
crosstab$data.name <- paste0(deparse(substitute(var1)), " and ", deparse(substitute(var2)))
names(dimnames(crosstab$observed)) <- c(deparse(substitute(var1)),deparse(substitute(var2)))
#crosstab$observed
#crosstab$expected
tab <- list(crosstab$observed, crosstab$expected)
names(tab) <- c("Observed Frequencies","Expected Frquencies")
tab
}
tab(mtcars, am, cyl)
tab <- function(df, var1, var2){
options(warn=-1) # suppress warnings for chi square run
#v1 <- paste0(substitute(df),"$",substitute(var1)) # how to use $ operator in dataframe$variable
#v2 <- paste0(substitute(df),"$",substitute(var2)) # how to use $ operator in dataframe$variable
v1 <- (eval(substitute(var1), df))
v2 <- (eval(substitute(var2), df))
crosstab <- chisq.test(v1, v2, correct=FALSE, war)
options(warn=0) # unsuppress warnings for chi square
crosstab$data.name <- paste0(deparse(substitute(var1)), " and ", deparse(substitute(var2)))
names(dimnames(crosstab$observed)) <- c(deparse(substitute(var1)),deparse(substitute(var2)))
names(dimnames(crosstab$expected)) <- c(deparse(substitute(var1)),deparse(substitute(var2)))
#crosstab$observed
#crosstab$expected
tab <- list(crosstab$observed, crosstab$expected)
names(tab) <- c("Observed Frequencies","Expected Frquencies")
tab
}
tab(mtcars, am, cyl)
tab <- function(df, var1, var2){
options(warn=-1) # suppress warnings for chi square run
#v1 <- paste0(substitute(df),"$",substitute(var1)) # how to use $ operator in dataframe$variable
#v2 <- paste0(substitute(df),"$",substitute(var2)) # how to use $ operator in dataframe$variable
v1 <- (eval(substitute(var1), df))
v2 <- (eval(substitute(var2), df))
crosstab <- chisq.test(v1, v2, correct=FALSE)
options(warn=0) # unsuppress warnings for chi square
crosstab$data.name <- paste0(deparse(substitute(var1)), " and ", deparse(substitute(var2)))
names(dimnames(crosstab$observed)) <- c(deparse(substitute(var1)),deparse(substitute(var2)))
names(dimnames(crosstab$expected)) <- c(deparse(substitute(var1)),deparse(substitute(var2)))
#crosstab$observed
#crosstab$expected
tab <- list(crosstab$observed, crosstab$expected)
names(tab) <- c("Observed Frequencies","Expected Frquencies")
return(tab)
}
tab(mtcars, am, cyl)
